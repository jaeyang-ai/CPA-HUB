<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CPA ì œíœ´ë§ˆì¼€íŒ… í—ˆë¸Œ</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0a0f;
    --surface: #111118;
    --surface2: #1a1a24;
    --border: #2a2a3a;
    --accent: #00e5ff;
    --accent2: #7c3aed;
    --accent3: #f59e0b;
    --text: #e8e8f0;
    --muted: #6b6b85;
    --green: #10b981;
    --red: #ef4444;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    background:var(--bg); color:var(--text);
    font-family:'Noto Sans KR',sans-serif;
    min-height:100vh; overflow-x:hidden;
  }
  body::before {
    content:''; position:fixed; inset:0;
    background-image:
      linear-gradient(rgba(0,229,255,0.03) 1px,transparent 1px),
      linear-gradient(90deg,rgba(0,229,255,0.03) 1px,transparent 1px);
    background-size:40px 40px; pointer-events:none; z-index:0;
  }

  header {
    z-index:100; padding:20px 40px;
    border-bottom:1px solid var(--border);
    display:flex; align-items:center; justify-content:space-between;
    background:rgba(10,10,15,0.97); backdrop-filter:blur(20px);
    position:sticky; top:0;
  }
  .logo { display:flex; align-items:center; gap:12px; }
  .logo:hover .logo-text { color: var(--accent); }
  .logo:hover .logo-icon { transform: scale(1.08); }
  .logo .logo-icon { transition: transform 0.2s; }
  .logo .logo-text { transition: color 0.2s; }
  .logo-icon {
    width:36px; height:36px;
    background:linear-gradient(135deg,var(--accent),var(--accent2));
    border-radius:8px; display:flex; align-items:center;
    justify-content:center; font-size:18px;
  }
  .logo-text { font-size:20px; font-weight:900; letter-spacing:-0.5px; }
  .logo-text span { color:var(--accent); }
  .header-right { display:flex; align-items:center; gap:16px; }
  .header-meta { font-family:'Space Mono',monospace; font-size:11px; color:var(--muted); text-align:right; line-height:1.8; }
  .add-site-btn {
    display:flex; align-items:center; gap:8px;
    padding:9px 18px;
    background:linear-gradient(135deg,rgba(0,229,255,0.15),rgba(124,58,237,0.15));
    border:1px solid var(--accent);
    border-radius:8px; color:var(--accent);
    font-family:'Noto Sans KR',sans-serif; font-size:13px; font-weight:700;
    cursor:pointer; transition:all 0.2s; white-space:nowrap;
  }
  .add-site-btn:hover { background:rgba(0,229,255,0.25); box-shadow:0 0 20px rgba(0,229,255,0.2); }

  .tab-nav {
    position:sticky; top:77px; z-index:99;
    padding:0 40px;
    background:var(--surface); border-bottom:1px solid var(--border);
    display:flex; gap:4px; overflow-x:auto; scrollbar-width:none;
  }
  .tab-nav::-webkit-scrollbar { display:none; }
  .tab-btn {
    padding:14px 20px; background:none; border:none;
    color:var(--muted); font-family:'Noto Sans KR',sans-serif;
    font-size:13px; font-weight:500; cursor:pointer;
    white-space:nowrap; position:relative; transition:color 0.2s;
    display:flex; align-items:center; gap:8px;
  }
  .tab-btn::after {
    content:''; position:absolute; bottom:0; left:0; right:0;
    height:2px; background:var(--accent); transform:scaleX(0); transition:transform 0.2s;
  }
  .tab-btn.active { color:var(--accent); }
  .tab-btn.active::after { transform:scaleX(1); }
  .tab-btn:hover { color:var(--text); }
  .tab-count {
    background:var(--surface2); border:1px solid var(--border);
    border-radius:20px; padding:1px 7px;
    font-size:10px; font-family:'Space Mono',monospace;
  }
  .tab-btn.active .tab-count {
    background:rgba(0,229,255,0.15); border-color:var(--accent); color:var(--accent);
  }

  .main { position:relative; z-index:1; padding:32px 40px; }
  .panel { display:none; }
  .panel.active { display:block; }

  .section-title {
    font-size:12px; font-weight:700; color:var(--muted);
    text-transform:uppercase; letter-spacing:2px;
    margin-bottom:20px; display:flex; align-items:center; gap:10px;
  }
  .section-title::after { content:''; flex:1; height:1px; background:var(--border); }

  .stats-bar { display:grid; grid-template-columns:repeat(4,1fr); gap:12px; margin-bottom:28px; }
  .stat-item {
    background:var(--surface); border:1px solid var(--border);
    border-radius:12px; padding:18px 20px; animation:fadeInUp 0.4s both;
  }
  .stat-label { font-size:11px; color:var(--muted); margin-bottom:8px; font-weight:500; }
  .stat-value { font-family:'Space Mono',monospace; font-size:24px; font-weight:700; color:var(--accent); line-height:1; }
  .stat-sub { font-size:11px; color:var(--muted); margin-top:4px; }

  .sites-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(290px,1fr)); gap:16px; }

  .site-card {
    background:var(--surface); border:1px solid var(--border);
    border-radius:14px; padding:22px; cursor:pointer;
    transition:all 0.25s cubic-bezier(0.4,0,0.2,1);
    position:relative; overflow:hidden;
    text-decoration:none; display:block;
    animation:fadeInUp 0.35s both;
  }
  .site-card::before {
    content:''; position:absolute; inset:0;
    background:linear-gradient(135deg,transparent 60%,rgba(0,229,255,0.04));
    opacity:0; transition:opacity 0.3s;
  }
  .site-card:hover { border-color:var(--accent); transform:translateY(-3px); box-shadow:0 12px 40px rgba(0,229,255,0.1); }
  .site-card:hover::before { opacity:1; }

  .site-card-header { display:flex; align-items:flex-start; justify-content:space-between; margin-bottom:14px; }
  .site-emoji {
    width:42px; height:42px; border-radius:10px;
    display:flex; align-items:center; justify-content:center; font-size:20px; flex-shrink:0;
  }
  .site-badge {
    font-family:'Space Mono',monospace; font-size:10px;
    padding:3px 9px; border-radius:20px; font-weight:700; letter-spacing:0.5px;
  }
  .badge-cpa { background:rgba(16,185,129,0.15); color:var(--green); border:1px solid rgba(16,185,129,0.3); }
  .badge-cpj { background:rgba(245,158,11,0.15); color:var(--accent3); border:1px solid rgba(245,158,11,0.3); }
  .badge-cpc { background:rgba(0,229,255,0.12); color:var(--accent); border:1px solid rgba(0,229,255,0.3); }
  .badge-multi { background:rgba(124,58,237,0.15); color:#a78bfa; border:1px solid rgba(124,58,237,0.3); }
  .badge-custom { background:rgba(245,158,11,0.15); color:var(--accent3); border:1px solid rgba(245,158,11,0.3); }

  .site-name { font-size:17px; font-weight:700; margin-bottom:3px; color:var(--text); }
  .site-url { font-family:'Space Mono',monospace; font-size:11px; color:var(--muted); margin-bottom:10px; }
  .site-desc { font-size:12px; color:var(--muted); line-height:1.6; }
  .site-card-footer {
    margin-top:16px; padding-top:14px; border-top:1px solid var(--border);
    display:flex; align-items:center; justify-content:space-between;
  }
  .open-btn { display:flex; align-items:center; gap:6px; font-size:12px; font-weight:600; color:var(--accent); }
  .open-arrow { transition:transform 0.2s; }
  .site-card:hover .open-arrow { transform:translateX(3px); }

  .delete-card-btn {
    width:26px; height:26px; border-radius:50%;
    background:rgba(239,68,68,0.1); border:1px solid rgba(239,68,68,0.3);
    color:var(--red); font-size:11px; cursor:pointer;
    display:flex; align-items:center; justify-content:center;
    transition:all 0.2s;
    position:absolute; top:12px; right:12px; z-index:10;
  }
  .delete-card-btn:hover { background:rgba(239,68,68,0.3); }

  /* ì‚¬ì´íŠ¸ ë·°ì–´ */
  .site-selector { display:flex; gap:8px; margin-bottom:14px; flex-wrap:wrap; }
  .site-select-btn {
    padding:8px 14px; background:var(--surface); border:1px solid var(--border);
    border-radius:8px; color:var(--muted); font-size:12px; font-weight:500;
    cursor:pointer; font-family:'Noto Sans KR',sans-serif; transition:all 0.2s;
  }
  .site-select-btn:hover,.site-select-btn.active {
    background:rgba(0,229,255,0.1); border-color:var(--accent); color:var(--accent);
  }
  .iframe-panel { background:var(--surface); border:1px solid var(--border); border-radius:14px; overflow:hidden; }
  .iframe-toolbar {
    padding:12px 16px; background:var(--surface2); border-bottom:1px solid var(--border);
    display:flex; align-items:center; gap:10px;
  }
  .iframe-dots { display:flex; gap:6px; }
  .iframe-dots span { width:10px; height:10px; border-radius:50%; }
  .dot-r{background:#ef4444;} .dot-y{background:#f59e0b;} .dot-g{background:#10b981;}
  .iframe-url-bar {
    flex:1; background:var(--bg); border:1px solid var(--border); border-radius:6px;
    padding:5px 12px; font-family:'Space Mono',monospace; font-size:11px; color:var(--muted);
    display:flex; align-items:center; gap:8px;
  }
  .iframe-action-btn {
    padding:5px 12px; background:none; border:1px solid var(--border); border-radius:6px;
    color:var(--muted); font-size:11px; cursor:pointer; font-family:'Noto Sans KR',sans-serif;
    transition:all 0.2s; text-decoration:none; display:inline-flex; align-items:center; gap:4px;
  }
  .iframe-action-btn:hover { border-color:var(--accent); color:var(--accent); }
  .site-iframe { width:100%; height:calc(100vh - 360px); min-height:480px; border:none; display:block; }
  .iframe-blocked {
    display:none; flex-direction:column; align-items:center;
    justify-content:center; height:360px; gap:16px; color:var(--muted);
  }
  .open-ext-btn {
    padding:10px 22px; background:var(--accent); color:#000;
    border:none; border-radius:8px; font-size:13px; font-weight:700;
    font-family:'Noto Sans KR',sans-serif; cursor:pointer; text-decoration:none;
    display:inline-flex; align-items:center; gap:6px; transition:opacity 0.2s;
  }
  .open-ext-btn:hover { opacity:0.85; }

  /* ëª¨ë‹¬ */
  .modal-overlay {
    position:fixed; inset:0; background:rgba(0,0,0,0.75);
    backdrop-filter:blur(10px); z-index:1000;
    display:flex; align-items:center; justify-content:center;
    opacity:0; pointer-events:none; transition:opacity 0.25s;
  }
  .modal-overlay.open { opacity:1; pointer-events:all; }
  .modal {
    background:var(--surface); border:1px solid var(--border); border-radius:18px;
    padding:32px; width:100%; max-width:500px; margin:20px;
    transform:translateY(24px); transition:transform 0.25s;
    box-shadow:0 32px 80px rgba(0,0,0,0.6);
  }
  .modal-overlay.open .modal { transform:translateY(0); }
  .modal-title { font-size:19px; font-weight:900; margin-bottom:6px; }
  .modal-sub { font-size:13px; color:var(--muted); margin-bottom:24px; line-height:1.7; }
  .form-group { margin-bottom:16px; }
  .form-label { font-size:11px; font-weight:700; color:var(--muted); margin-bottom:7px; display:block; letter-spacing:0.8px; text-transform:uppercase; }
  .form-input {
    width:100%; padding:11px 14px;
    background:var(--surface2); border:1px solid var(--border); border-radius:8px;
    color:var(--text); font-family:'Noto Sans KR',sans-serif; font-size:14px;
    outline:none; transition:border-color 0.2s;
  }
  .form-input:focus { border-color:var(--accent); }
  .form-input::placeholder { color:var(--muted); }
  .form-row { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
  .emoji-picker { display:flex; flex-wrap:wrap; gap:7px; margin-top:8px; }
  .emoji-opt {
    width:38px; height:38px; border-radius:8px;
    background:var(--surface2); border:2px solid transparent;
    font-size:18px; cursor:pointer; display:flex; align-items:center; justify-content:center;
    transition:all 0.15s;
  }
  .emoji-opt:hover { border-color:rgba(0,229,255,0.4); }
  .emoji-opt.selected { border-color:var(--accent); background:rgba(0,229,255,0.1); }

  /* ê´‘ê³ ìœ í˜• ì„ íƒ */
  .ad-type-picker { display:flex; gap:10px; margin-top:8px; }
  .ad-type-opt {
    flex:1; padding:10px; border-radius:8px; text-align:center;
    background:var(--surface2); border:2px solid var(--border);
    color:var(--muted); font-family:'Space Mono',monospace;
    font-size:13px; font-weight:700; cursor:pointer;
    transition:all 0.18s; letter-spacing:0.5px;
  }
  .ad-type-opt:hover { border-color:rgba(0,229,255,0.4); color:var(--text); }
  .ad-type-opt.selected[data-type="CPA"] { border-color:var(--green); background:rgba(16,185,129,0.15); color:var(--green); }
  .ad-type-opt.selected[data-type="CPJ"] { border-color:var(--accent3); background:rgba(245,158,11,0.15); color:var(--accent3); }
  .ad-type-opt.selected[data-type="CPC"] { border-color:var(--accent); background:rgba(0,229,255,0.12); color:var(--accent); }
  .modal-actions { display:flex; gap:10px; margin-top:24px; }
  .btn-cancel {
    flex:1; padding:12px; background:var(--surface2); border:1px solid var(--border);
    border-radius:8px; color:var(--muted); font-family:'Noto Sans KR',sans-serif;
    font-size:14px; font-weight:600; cursor:pointer; transition:all 0.2s;
  }
  .btn-cancel:hover { color:var(--text); }
  .btn-add {
    flex:2; padding:12px; background:linear-gradient(135deg,var(--accent),#00b8d4);
    border:none; border-radius:8px; color:#000;
    font-family:'Noto Sans KR',sans-serif; font-size:14px; font-weight:900;
    cursor:pointer; transition:opacity 0.2s;
  }
  .btn-add:hover { opacity:0.9; }

  /* í† ìŠ¤íŠ¸ */
  .toast {
    position:fixed; bottom:24px; right:24px; z-index:2000;
    background:var(--surface2); border:1px solid var(--green); border-radius:10px;
    padding:13px 20px; font-size:13px; font-weight:600; color:var(--green);
    display:flex; align-items:center; gap:10px;
    transform:translateY(80px); opacity:0; transition:all 0.3s;
    box-shadow:0 8px 32px rgba(0,0,0,0.5);
  }
  .toast.show { transform:translateY(0); opacity:1; }

  /* ê´€ë¦¬ íƒ­ í–‰ */
  .manage-row {
    display:flex; align-items:center; gap:14px;
    padding:14px 18px; background:var(--surface);
    border:1px solid var(--border); border-radius:10px; margin-bottom:8px;
  }
  .manage-row-info { flex:1; }
  .manage-row-name { font-size:14px; font-weight:600; }
  .manage-row-url { font-size:11px; color:var(--muted); font-family:'Space Mono',monospace; margin-top:2px; }
  .manage-row-desc { font-size:11px; color:var(--muted); margin-top:2px; }
  .row-btn {
    padding:5px 12px; border-radius:6px; font-size:11px; cursor:pointer;
    font-family:'Noto Sans KR',sans-serif; text-decoration:none;
    display:inline-flex; align-items:center; transition:all 0.2s;
  }
  .row-btn-open { background:var(--surface2); border:1px solid var(--border); color:var(--muted); }
  .row-btn-open:hover { border-color:var(--accent); color:var(--accent); }
  .row-btn-edit { background:rgba(0,229,255,0.08); border:1px solid rgba(0,229,255,0.25); color:var(--accent); }
  .row-btn-edit:hover { background:rgba(0,229,255,0.18); }
  .row-btn-del { background:rgba(239,68,68,0.1); border:1px solid rgba(239,68,68,0.3); color:var(--red); }
  .row-btn-del:hover { background:rgba(239,68,68,0.22); }

  .empty-custom {
    padding:40px; text-align:center; color:var(--muted); font-size:13px;
    background:var(--surface); border:1px solid var(--border); border-radius:12px;
    line-height:1.8;
  }

  @keyframes fadeInUp {
    from { opacity:0; transform:translateY(14px); }
    to { opacity:1; transform:translateY(0); }
  }
  @media (max-width:768px) {
    header { padding:16px 20px; }
    .tab-nav { padding:0 16px; }
    .main { padding:20px; }
    .stats-bar { grid-template-columns:repeat(2,1fr); }
    .form-row { grid-template-columns:1fr; }
    .header-meta { display:none; }
  }
</style>
</head>
<body>

<header>
  <div class="logo" onclick="showTab('all', document.querySelector('.tab-btn'))" style="cursor:pointer;" title="ë©”ì¸ìœ¼ë¡œ ì´ë™">
    <div class="logo-icon">ğŸ“¡</div>
    <div class="logo-text">CPA <span>HUB</span></div>
  </div>
  <div class="header-right">
    <div class="header-meta">
      <div id="site-count-header">-- ê°œ í”Œë«í¼</div>
      <div id="current-time">--:--:--</div>
    </div>
    <button class="add-site-btn" onclick="openModal()">ï¼‹ ì‚¬ì´íŠ¸ ì¶”ê°€</button>
  </div>
</header>

<nav class="tab-nav">
  <button class="tab-btn active" onclick="showTab('all',this)">
    ğŸ  ì „ì²´ ì‚¬ì´íŠ¸ <span class="tab-count" id="tab-count-all">0</span>
  </button>
  <button class="tab-btn" onclick="showTab('viewer',this)">ğŸŒ ì‚¬ì´íŠ¸ ë·°ì–´</button>
  <button class="tab-btn" onclick="showTab('manage',this)">âš™ï¸ ê´€ë¦¬</button>
</nav>

<main class="main">

  <!-- ì „ì²´ ì‚¬ì´íŠ¸ -->
  <div id="tab-all" class="panel active">
    <div class="stats-bar">
      <div class="stat-item" style="animation-delay:0s">
        <div class="stat-label">ì´ í”Œë«í¼</div>
        <div class="stat-value" id="stat-total">0</div>
        <div class="stat-sub">ë“±ë¡ëœ ì‚¬ì´íŠ¸</div>
      </div>
      <div class="stat-item" style="animation-delay:0.08s">
        <div class="stat-label">ì˜¤ëŠ˜ ë‚ ì§œ</div>
        <div class="stat-value" id="stat-date" style="font-size:18px;padding-top:3px">--</div>
        <div class="stat-sub" id="stat-year">----</div>
      </div>
      <div class="stat-item" style="animation-delay:0.16s">
        <div class="stat-label">í˜„ì¬ ì‹œê°</div>
        <div class="stat-value" id="stat-clock" style="font-size:18px;padding-top:3px">--:--</div>
        <div class="stat-sub">ì‹¤ì‹œê°„</div>
      </div>
      <div class="stat-item" style="animation-delay:0.24s">
        <div class="stat-label">ìš”ì¼</div>
        <div class="stat-value" id="stat-day" style="font-size:20px;padding-top:2px">---</div>
        <div class="stat-sub" id="stat-week"></div>
      </div>
    </div>
    <div class="section-title">ëª¨ë“  í”Œë«í¼</div>
    <div class="sites-grid" id="all-grid"></div>
  </div>

  <!-- ì‚¬ì´íŠ¸ ë·°ì–´ -->
  <div id="tab-viewer" class="panel">
    <div class="section-title">ğŸŒ ì¸ë¼ì¸ ì‚¬ì´íŠ¸ ë·°ì–´</div>
    <div class="site-selector" id="viewer-btns"></div>
    <div class="iframe-panel">
      <div class="iframe-toolbar">
        <div class="iframe-dots">
          <span class="dot-r"></span><span class="dot-y"></span><span class="dot-g"></span>
        </div>
        <div class="iframe-url-bar">
          <span>ğŸ”’</span>
          <span id="iframe-url-display">ìœ„ì—ì„œ ì‚¬ì´íŠ¸ë¥¼ ì„ íƒí•˜ì„¸ìš”</span>
        </div>
        <a id="open-new-tab" href="#" target="_blank" class="iframe-action-btn">â†— ìƒˆ íƒ­</a>
      </div>
      <iframe id="main-iframe" src="about:blank" class="site-iframe"
        sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-top-navigation"
        referrerpolicy="no-referrer"></iframe>
      <div class="iframe-blocked" id="iframe-blocked">
        <div style="font-size:44px">ğŸš«</div>
        <div style="font-size:13px;text-align:center;line-height:1.9;color:var(--muted)">ì´ ì‚¬ì´íŠ¸ëŠ” ë³´ì•ˆ ì •ì±…ìœ¼ë¡œ ì¸í•´<br>ì¸ë¼ì¸ í‘œì‹œê°€ ì°¨ë‹¨ë©ë‹ˆë‹¤.</div>
        <a id="blocked-link" href="#" target="_blank" class="open-ext-btn">â†— ìƒˆ íƒ­ì—ì„œ ì—´ê¸°</a>
      </div>
    </div>
    <div style="margin-top:10px;font-size:12px;color:var(--muted);line-height:1.8">
      ğŸ’¡ ë³´ì•ˆ ì •ì±…ìœ¼ë¡œ ì¼ë¶€ ì‚¬ì´íŠ¸ëŠ” ì¸ë¼ì¸ í‘œì‹œê°€ ì°¨ë‹¨ë  ìˆ˜ ìˆì–´ìš”. ê·¸ëŸ´ ë• <strong style="color:var(--text)">ìƒˆ íƒ­</strong> ë²„íŠ¼ì„ ì´ìš©í•˜ì„¸ìš”.
    </div>
  </div>

  <!-- ê´€ë¦¬ -->
  <div id="tab-manage" class="panel">
    <div id="manage-list"></div>
    <div style="margin-top:32px;padding:20px;background:var(--surface);border:1px solid var(--border);border-radius:12px">
      <div style="font-size:13px;font-weight:700;margin-bottom:6px;color:var(--muted)">âš ï¸ ì „ì²´ ì´ˆê¸°í™”</div>
      <div style="font-size:12px;color:var(--muted);margin-bottom:14px;line-height:1.7">ì§ì ‘ ì¶”ê°€í•œ ì‚¬ì´íŠ¸ë¥¼ ì‚­ì œí•˜ê³ , ìˆ¨ê¸´ ê¸°ë³¸ ì‚¬ì´íŠ¸ë„ ëª¨ë‘ ë³µì›í•´ ì›ë˜ ìƒíƒœë¡œ ë˜ëŒë¦½ë‹ˆë‹¤.</div>
      <button onclick="resetCustomSites()"
        style="padding:8px 20px;background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);border-radius:8px;color:var(--red);font-family:'Noto Sans KR',sans-serif;font-size:13px;cursor:pointer;transition:all 0.2s"
        onmouseover="this.style.background='rgba(239,68,68,0.22)'" onmouseout="this.style.background='rgba(239,68,68,0.1)'">
        ì¶”ê°€ ì‚¬ì´íŠ¸ ì „ì²´ ì‚­ì œ
      </button>
    </div>
  </div>

</main>

<!-- ëª¨ë‹¬ -->
<div class="modal-overlay" id="modal-overlay" onclick="closeModalOutside(event)">
  <div class="modal">
    <div class="modal-title">ï¼‹ ìƒˆ ì‚¬ì´íŠ¸ ì¶”ê°€</div>
    <div class="modal-sub">URLì„ ì…ë ¥í•˜ë©´ ì´ë¦„ì´ ìë™ìœ¼ë¡œ ì±„ì›Œì ¸ìš”.<br>ì•„ì´ì½˜ê³¼ ì´ë¦„ì€ ì›í•˜ëŠ” ëŒ€ë¡œ ë°”ê¿€ ìˆ˜ ìˆì–´ìš”.</div>

    <div class="form-group">
      <label class="form-label">ì‚¬ì´íŠ¸ URL *</label>
      <input class="form-input" id="input-url" type="url" placeholder="https://example.com" oninput="autoFillName()" />
    </div>

    <div class="form-group">
      <label class="form-label">ì‚¬ì´íŠ¸ ì´ë¦„ *</label>
      <input class="form-input" id="input-name" type="text" placeholder="ì˜ˆ: ìƒˆ í”Œë«í¼" maxlength="20" />
    </div>

    <div class="form-group">
      <label class="form-label">ê´‘ê³ ìœ í˜• (ì„ íƒ, ë³µìˆ˜ ê°€ëŠ¥)</label>
      <div class="ad-type-picker">
        <div class="ad-type-opt" data-type="CPA" onclick="toggleAdType(this)">CPA</div>
        <div class="ad-type-opt" data-type="CPJ" onclick="toggleAdType(this)">CPJ</div>
        <div class="ad-type-opt" data-type="CPC" onclick="toggleAdType(this)">CPC</div>
      </div>
    </div>

    <div class="form-group">
      <label class="form-label">ì„¤ëª…ê¸€ (ì„ íƒ)</label>
      <textarea class="form-input" id="input-detail" placeholder="ì¹´ë“œì— í‘œì‹œë  ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”.&#10;ì˜ˆ: DB ìˆ˜ì§‘ ì „ë¬¸ í”Œë«í¼. ê¸ˆìœµÂ·ë³´í—˜ ìº í˜ì¸ ë‹¤ìˆ˜." maxlength="100" style="resize:none;height:76px;line-height:1.6;padding-top:10px;"></textarea>
    </div>

    <div class="form-group">
      <label class="form-label">ì•„ì´ì½˜</label>
      <div class="emoji-picker" id="emoji-picker"></div>
    </div>

    <div class="modal-actions">
      <button class="btn-cancel" onclick="closeModal()">ì·¨ì†Œ</button>
      <button class="btn-add" onclick="addSite()">ì¶”ê°€í•˜ê¸° â†’</button>
    </div>
  </div>
</div>

<!-- ìˆ˜ì • ëª¨ë‹¬ -->
<div class="modal-overlay" id="edit-modal-overlay" onclick="closeEditModalOutside(event)">
  <div class="modal">
    <div class="modal-title">âœï¸ ì‚¬ì´íŠ¸ ìˆ˜ì •</div>
    <div class="modal-sub">ë‚´ìš©ì„ ìˆ˜ì •í•˜ê³  ì €ì¥í•˜ì„¸ìš”.</div>
    <input type="hidden" id="edit-id" />
    <input type="hidden" id="edit-is-default" />

    <div class="form-group">
      <label class="form-label">ì‚¬ì´íŠ¸ URL *</label>
      <input class="form-input" id="edit-url" type="url" placeholder="https://example.com" />
    </div>

    <div class="form-group">
      <label class="form-label">ì‚¬ì´íŠ¸ ì´ë¦„ *</label>
      <input class="form-input" id="edit-name" type="text" maxlength="20" />
    </div>

    <div class="form-group">
      <label class="form-label">ê´‘ê³ ìœ í˜• (ë³µìˆ˜ ê°€ëŠ¥)</label>
      <div class="ad-type-picker" id="edit-ad-type-picker">
        <div class="ad-type-opt" data-type="CPA" onclick="toggleEditAdType(this)">CPA</div>
        <div class="ad-type-opt" data-type="CPJ" onclick="toggleEditAdType(this)">CPJ</div>
        <div class="ad-type-opt" data-type="CPC" onclick="toggleEditAdType(this)">CPC</div>
      </div>
    </div>

    <div class="form-group">
      <label class="form-label">ì„¤ëª…ê¸€</label>
      <textarea class="form-input" id="edit-detail" maxlength="100" style="resize:none;height:76px;line-height:1.6;padding-top:10px;"></textarea>
    </div>

    <div class="form-group">
      <label class="form-label">ì•„ì´ì½˜</label>
      <div class="emoji-picker" id="edit-emoji-picker"></div>
    </div>

    <div class="modal-actions">
      <button class="btn-cancel" onclick="closeEditModal()">ì·¨ì†Œ</button>
      <button class="btn-add" onclick="saveSite()">ì €ì¥í•˜ê¸° âœ“</button>
    </div>
  </div>
</div>

<!-- í† ìŠ¤íŠ¸ -->
<div class="toast" id="toast">âœ… <span id="toast-msg"></span></div>

<script>
const DEFAULT_SITES = [
  { id:'tenping',   name:'í…í•‘',       url:'https://tenping.kr/',    emoji:'ğŸ¯', desc:'í¼í¬ë¨¼ìŠ¤ë§ˆì¼€í„° ì „ìš©. ì°¸ì—¬Â·í´ë¦­Â·ì„¤ì¹˜Â·ì œíœ´ëª° ë‹¤ì–‘í•œ ìœ í˜•',    badge:'CPA+CPC',     color:'linear-gradient(135deg,#1e3a5f,#0ea5e9)', isDefault:true },
  { id:'dbdbdeep',  name:'ë””ë¹„ë””ë¹„ë”¥', url:'https://www.dbdbdeep.com', emoji:'ğŸ“Š', desc:'DB ìˆ˜ì§‘ ì „ë¬¸ CPA í”Œë«í¼. ê¸ˆìœµÂ·ë³´í—˜Â·ë¶€ë™ì‚° ê°•ì„¸',         badge:'CPA',         color:'linear-gradient(135deg,#312e81,#7c3aed)', isDefault:true },
  { id:'albarich',  name:'ì•Œë°”ë¦¬ì¹˜',   url:'https://albarich.com/partner/merchant.list.php?cate=1&sort=wdate', emoji:'ğŸ’°', desc:'íŒŒíŠ¸ë„ˆ ê´‘ê³ ì£¼ ëª©ë¡ ì§ì ‘ ì ‘ê·¼ ê°€ëŠ¥. ìƒí™œÂ·êµìœ¡Â·ì·¨ì—…', badge:'CPA', color:'linear-gradient(135deg,#064e3b,#10b981)', isDefault:true },
  { id:'replyalba', name:'ë¦¬í”Œì•Œë°”',   url:'https://www.replyalba.com/', emoji:'ğŸ’¬', desc:'ëŒ“ê¸€Â·ë¦¬í”Œ í˜•íƒœì˜ CPA ë§ˆì¼€íŒ…. ë°”ì´ëŸ´ ë§ˆì¼€íŒ… íŠ¹í™”',      badge:'CPA',         color:'linear-gradient(135deg,#7c2d12,#f97316)', isDefault:true },
  { id:'dbfactory', name:'ë””ë¹„íŒ©í† ë¦¬', url:'https://www.dbfactory.kr/',  emoji:'ğŸ­', desc:'ëŒ€ëŸ‰ DB ìº í˜ì¸ê³¼ ê³ ë‹¨ê°€ ê²½ìŸë ¥ ê°•ì ',                  badge:'CPA',         color:'linear-gradient(135deg,#1e293b,#475569)', isDefault:true },
  { id:'adpot',     name:'ì• ë“œíŒŸ',     url:'https://adpot.kr/',          emoji:'ğŸ“£', desc:'CPAÂ·CPJÂ·CPC ëª¨ë“  ìœ í˜•. ë§ˆì¼€í„° ë§¤ë‹ˆì € ì‹œìŠ¤í…œ ìš´ì˜',    badge:'CPA+CPJ+CPC', color:'linear-gradient(135deg,#0c4a6e,#0284c7)', isDefault:true },
  { id:'dbsense',       name:'ë””ë¹„ì„¼ìŠ¤',     url:'https://dbsense.kr/',              emoji:'ğŸ§ ', desc:'íŒ€ ì œë„ì™€ ì§€ì‹ë§ˆì¼“. ë§ˆì¼€í„° ì»¤ë®¤ë‹ˆí‹° ê¸°ëŠ¥ ê°•ì ',              badge:'CPA+CPC',     color:'linear-gradient(135deg,#4a044e,#c026d3)', isDefault:true },
  { id:'leaderscpa',    name:'ë¦¬ë”ìŠ¤CPA',    url:'https://leaderscpa.com/',          emoji:'ğŸ‘‘', desc:'êµ­ë‚´ CPA ë§ˆì¼€íŒ… 1ìœ„ í”Œë«í¼. DB ë°œìƒ ì¦‰ì‹œ 100% í™•ì • ìº í˜ì¸ ìš´ì˜', badge:'CPA',         color:'linear-gradient(135deg,#1a1a2e,#dc2626)', isDefault:true },
  { id:'adpick',        name:'ì• ë“œí”½',       url:'https://adpick.co.kr/',            emoji:'ğŸ“²', desc:'90ë§Œ+ íšŒì› ì¸í”Œë£¨ì–¸ì„œ ë§ˆì¼€íŒ… í”Œë«í¼. SNSÂ·ë¸”ë¡œê·¸Â·ì•± ê¸°ë°˜ ìˆ˜ìµ', badge:'CPA+CPC',     color:'linear-gradient(135deg,#0f172a,#f97316)', isDefault:true },
  { id:'linkprice',     name:'ë§í¬í”„ë¼ì´ìŠ¤', url:'https://ac.linkprice.net/',        emoji:'ğŸ”—', desc:'êµ­ë‚´ ì œíœ´ë§ˆì¼€íŒ… ì„ ë‘ ê¸°ì—…. CPSÂ·CPAÂ·CPCÂ·CPI ì „ë°©ìœ„ ì§€ì›',    badge:'CPA+CPC',     color:'linear-gradient(135deg,#042f2e,#0d9488)', isDefault:true },
  { id:'pointclick',    name:'í¬ì¸íŠ¸í´ë¦­',   url:'https://www.pointclick.co.kr/',    emoji:'ğŸ–±ï¸', desc:'ì˜¤í¼ì›” ê¸°ë°˜ ë¦¬ì›Œë“œ ê´‘ê³  í”Œë«í¼. CPAÂ·CPCÂ·CPI ë‹¤ì–‘í•œ ê´‘ê³  ìœ í˜•', badge:'CPA+CPC',   color:'linear-gradient(135deg,#1e1b4b,#6366f1)', isDefault:true },
  { id:'commissionbank',name:'ì»¤ë¯¸ì…˜ë±…í¬',   url:'https://www.commissionbank.co.kr/',emoji:'ğŸ¦', desc:'í¼í¬ë¨¼ìŠ¤ ê¸°ë°˜ ì œíœ´ë§ˆì¼€íŒ… í”Œë«í¼. ë‹¤ì–‘í•œ ê´‘ê³ ì£¼ ìº í˜ì¸ ìš´ì˜',   badge:'CPA',         color:'linear-gradient(135deg,#0c2340,#2563eb)', isDefault:true },
  { id:'infomaster',    name:'ì¸í¬ë§ˆìŠ¤í„°',   url:'https://www.infomaster.co.kr/',    emoji:'ğŸ“‹', desc:'AI ì½˜í…ì¸  ë§ˆì¼€íŒ… ì •ë³´í¬í„¸. ì •ë³´ëª° ìº í˜ì¸ ë° DB ë§ˆì¼€íŒ… íŠ¹í™”',  badge:'CPA',         color:'linear-gradient(135deg,#1c1917,#78716c)', isDefault:true },
];

const EMOJIS = ['ğŸ¯','ğŸ“Š','ğŸ’°','ğŸ’¬','ğŸ­','ğŸ“£','ğŸ§ ','ğŸš€','âš¡','ğŸ”¥','ğŸ’','ğŸŒŸ','ğŸ“±','ğŸ’»','ğŸª','ğŸ','ğŸ“ˆ','ğŸ†','ğŸ”—','ğŸ“Œ','ğŸ’¡','ğŸŒ','âš™ï¸','ğŸ›’','ğŸ€'];
const GRADIENTS = [
  'linear-gradient(135deg,#1e3a5f,#0ea5e9)',
  'linear-gradient(135deg,#312e81,#7c3aed)',
  'linear-gradient(135deg,#064e3b,#10b981)',
  'linear-gradient(135deg,#7c2d12,#f97316)',
  'linear-gradient(135deg,#0c4a6e,#0284c7)',
  'linear-gradient(135deg,#4a044e,#c026d3)',
  'linear-gradient(135deg,#1a1a2e,#3b82f6)',
  'linear-gradient(135deg,#1c1917,#a3a3a3)',
  'linear-gradient(135deg,#14532d,#86efac)',
  'linear-gradient(135deg,#450a0a,#fca5a5)',
];

let selectedEmoji = 'ğŸŒ';

// â”€â”€ ì €ì¥ì†Œ â”€â”€
function getHidden() {
  try { return JSON.parse(localStorage.getItem('cpa_hidden') || '[]'); }
  catch { return []; }
}
function saveHidden(arr) { localStorage.setItem('cpa_hidden', JSON.stringify(arr)); }

function getSites() {
  try {
    const hidden = getHidden();
    const custom = JSON.parse(localStorage.getItem('cpa_custom') || '[]');
    const overrides = getOverrides();
    const visibleDefaults = DEFAULT_SITES
      .filter(s => !hidden.includes(s.id))
      .map(s => overrides[s.id] ? { ...s, ...overrides[s.id] } : s);
    return [...visibleDefaults, ...custom];
  } catch { return [...DEFAULT_SITES]; }
}
function getCustom() {
  try { return JSON.parse(localStorage.getItem('cpa_custom') || '[]'); }
  catch { return []; }
}
function saveCustom(arr) { localStorage.setItem('cpa_custom', JSON.stringify(arr)); }

// â”€â”€ ìœ í‹¸ â”€â”€
function getDomain(url) {
  try { return new URL(url).hostname.replace('www.',''); }
  catch { return url; }
}
function getBadgeClass(badge) {
  if (!badge || badge === 'CPA') return 'badge-cpa';
  if (badge === 'CPJ') return 'badge-cpj';
  if (badge === 'CPC') return 'badge-cpc';
  if (badge === 'custom') return 'badge-custom';
  return 'badge-multi';
}
function randomGradient() { return GRADIENTS[Math.floor(Math.random() * GRADIENTS.length)]; }

// â”€â”€ ë Œë” â”€â”€
function render() {
  const sites = getSites();
  const custom = getCustom();

  document.getElementById('stat-total').textContent = sites.length;
  document.getElementById('tab-count-all').textContent = sites.length;
  document.getElementById('site-count-header').textContent = sites.length + 'ê°œ í”Œë«í¼';

  renderGrid(sites);
  renderViewerBtns(sites);
  renderManage(sites, custom);
}

function renderGrid(sites) {
  const grid = document.getElementById('all-grid');
  grid.innerHTML = sites.map((s, i) => `
    <a href="${s.url}" target="_blank" class="site-card" style="animation-delay:${i*0.045}s">

      <div class="site-card-header">
        <div style="display:flex;align-items:center;gap:11px">
          <div class="site-emoji" style="background:${s.color||GRADIENTS[0]}">${s.emoji}</div>
          <div>
            <div class="site-name">${s.name}</div>
            <div class="site-url">${getDomain(s.url)}</div>
          </div>
        </div>
        <span class="site-badge ${getBadgeClass(s.badge)}">${s.badge||'CPA'}</span>
      </div>
      <div class="site-desc">${s.desc||''}</div>
      <div class="site-card-footer">
        <span class="open-btn">ì‚¬ì´íŠ¸ ì—´ê¸° <span class="open-arrow">â†’</span></span>
        <span style="font-size:11px;color:var(--muted)">${s.isDefault ? 'ê¸°ë³¸ ì œê³µ' : 'â­ ì§ì ‘ ì¶”ê°€'}</span>
      </div>
    </a>
  `).join('');
}

function renderViewerBtns(sites) {
  document.getElementById('viewer-btns').innerHTML = sites.map(s =>
    `<button class="site-select-btn" onclick="loadSite('${s.url}',this,'${getDomain(s.url)}')">${s.emoji} ${s.name}</button>`
  ).join('');
}

function renderManage(sites, custom) {
  const defaults = sites.filter(s => s.isDefault);
  let html = '';

  html += `<div class="section-title">ê¸°ë³¸ ì œê³µ ì‚¬ì´íŠ¸ (${defaults.length}ê°œ)</div>`;
  defaults.forEach(s => {
    html += `<div class="manage-row">
      <span style="font-size:20px">${s.emoji}</span>
      <div class="manage-row-info">
        <div class="manage-row-name">${s.name}</div>
        <div class="manage-row-url">${getDomain(s.url)}</div>
      </div>
      <span class="site-badge ${getBadgeClass(s.badge)}">${s.badge||'CPA'}</span>
      <a href="${s.url}" target="_blank" class="row-btn row-btn-open">â†— ì—´ê¸°</a>
      <button onclick="openEditModal('${s.id}',true)" class="row-btn row-btn-edit">âœï¸ ìˆ˜ì •</button>
      <button onclick="deleteSite(event,'${s.id}',true)" class="row-btn row-btn-del">ì‚­ì œ</button>
    </div>`;
  });

  html += `<div class="section-title" style="margin-top:28px">ë‚´ê°€ ì¶”ê°€í•œ ì‚¬ì´íŠ¸ (${custom.length}ê°œ)</div>`;
  if (custom.length === 0) {
    html += `<div class="empty-custom">ì•„ì§ ì¶”ê°€í•œ ì‚¬ì´íŠ¸ê°€ ì—†ì–´ìš”.<br>ìš°ì¸¡ ìƒë‹¨ <strong style="color:var(--text)">ï¼‹ ì‚¬ì´íŠ¸ ì¶”ê°€</strong>ë¥¼ ëˆŒëŸ¬ë³´ì„¸ìš”!</div>`;
  } else {
    custom.forEach(s => {
      html += `<div class="manage-row">
        <span style="font-size:20px">${s.emoji}</span>
        <div class="manage-row-info">
          <div class="manage-row-name">${s.name}</div>
          <div class="manage-row-url">${getDomain(s.url)}</div>
          ${s.desc ? `<div class="manage-row-desc">${s.desc}</div>` : ''}
        </div>
        <a href="${s.url}" target="_blank" class="row-btn row-btn-open">â†— ì—´ê¸°</a>
        <button onclick="openEditModal('${s.id}',false)" class="row-btn row-btn-edit">âœï¸ ìˆ˜ì •</button>
        <button onclick="deleteSite(event,'${s.id}')" class="row-btn row-btn-del">ì‚­ì œ</button>
      </div>`;
    });
  }

  document.getElementById('manage-list').innerHTML = html;
}

// â”€â”€ íƒ­ â”€â”€
function showTab(name, btn) {
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('tab-'+name).classList.add('active');
  (btn||event.currentTarget).classList.add('active');
}

// â”€â”€ ë·°ì–´ â”€â”€
function loadSite(url, btn, displayUrl) {
  document.querySelectorAll('#viewer-btns .site-select-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById('iframe-url-display').textContent = displayUrl;
  document.getElementById('open-new-tab').href = url;
  document.getElementById('blocked-link').href = url;
  const iframe = document.getElementById('main-iframe');
  iframe.style.display = 'block';
  document.getElementById('iframe-blocked').style.display = 'none';
  iframe.src = url;
}

// â”€â”€ ëª¨ë‹¬ â”€â”€
function buildEmojiPicker() {
  document.getElementById('emoji-picker').innerHTML = EMOJIS.map(e =>
    `<div class="emoji-opt${e===selectedEmoji?' selected':''}" onclick="selectEmoji('${e}',this)">${e}</div>`
  ).join('');
}

function selectEmoji(e, el) {
  selectedEmoji = e;
  document.querySelectorAll('.emoji-opt').forEach(o => o.classList.remove('selected'));
  el.classList.add('selected');
}

function toggleAdType(el) {
  el.classList.toggle('selected');
}

function getSelectedAdTypes() {
  const selected = [...document.querySelectorAll('.ad-type-opt.selected')].map(el => el.dataset.type);
  return selected.length ? selected.join('+') : 'custom';
}

function openModal() {
  document.getElementById('input-url').value = '';
  document.getElementById('input-name').value = '';
  document.getElementById('input-detail').value = '';
  document.querySelectorAll('.ad-type-opt').forEach(el => el.classList.remove('selected'));
  selectedEmoji = 'ğŸŒ';
  buildEmojiPicker();
  document.getElementById('modal-overlay').classList.add('open');
  setTimeout(() => document.getElementById('input-url').focus(), 200);
}

function closeModal() { document.getElementById('modal-overlay').classList.remove('open'); }
function closeModalOutside(e) { if(e.target.id==='modal-overlay') closeModal(); }

function autoFillName() {
  const url = document.getElementById('input-url').value.trim();
  const nameEl = document.getElementById('input-name');
  if (!nameEl.value && url) {
    try {
      const full = url.startsWith('http') ? url : 'https://'+url;
      const domain = new URL(full).hostname.replace('www.','').split('.')[0];
      nameEl.value = domain.charAt(0).toUpperCase() + domain.slice(1);
    } catch{}
  }
}

function addSite() {
  let url = document.getElementById('input-url').value.trim();
  const name = document.getElementById('input-name').value.trim();
  const detail = document.getElementById('input-detail').value.trim();
  const badge = getSelectedAdTypes();

  if (!url) { highlight('input-url'); return; }
  if (!name) { highlight('input-name'); return; }
  if (!url.startsWith('http')) url = 'https://' + url;

  const custom = getCustom();
  custom.push({
    id: 'c_' + Date.now(),
    name, url,
    desc: detail || 'ì§ì ‘ ì¶”ê°€í•œ ì‚¬ì´íŠ¸',
    emoji: selectedEmoji,
    badge,
    color: randomGradient(),
    isDefault: false,
  });
  saveCustom(custom);
  closeModal();
  render();
  showToast(`"${name}" ì¶”ê°€ ì™„ë£Œ!`);
}

// â”€â”€ ìˆ˜ì • ëª¨ë‹¬ â”€â”€
let editSelectedEmoji = 'ğŸŒ';

function openEditModal(id, isDefault) {
  // í˜„ì¬ ì‚¬ì´íŠ¸ ë°ì´í„° ì°¾ê¸°
  const allSites = getSites();
  // ê¸°ë³¸ ì‚¬ì´íŠ¸ëŠ” ë®ì–´ì“´ ë°ì´í„°(overrides)ë„ í™•ì¸
  const overrides = getOverrides();
  let site = overrides[id] || allSites.find(s => s.id === id);
  if (!site) return;

  document.getElementById('edit-id').value = id;
  document.getElementById('edit-is-default').value = isDefault ? 'true' : 'false';
  document.getElementById('edit-url').value = site.url;
  document.getElementById('edit-name').value = site.name;
  document.getElementById('edit-detail').value = site.desc || '';

  // ê´‘ê³ ìœ í˜• ì„¸íŒ…
  const types = (site.badge || '').split('+');
  document.querySelectorAll('#edit-ad-type-picker .ad-type-opt').forEach(el => {
    el.classList.toggle('selected', types.includes(el.dataset.type));
  });

  // ì´ëª¨ì§€ ì„¸íŒ…
  editSelectedEmoji = site.emoji || 'ğŸŒ';
  document.getElementById('edit-emoji-picker').innerHTML = EMOJIS.map(e =>
    `<div class="emoji-opt${e===editSelectedEmoji?' selected':''}" onclick="selectEditEmoji('${e}',this)">${e}</div>`
  ).join('');

  document.getElementById('edit-modal-overlay').classList.add('open');
  setTimeout(() => document.getElementById('edit-name').focus(), 200);
}

function selectEditEmoji(e, el) {
  editSelectedEmoji = e;
  document.querySelectorAll('#edit-emoji-picker .emoji-opt').forEach(o => o.classList.remove('selected'));
  el.classList.add('selected');
}

function toggleEditAdType(el) { el.classList.toggle('selected'); }

function getEditSelectedAdTypes() {
  const selected = [...document.querySelectorAll('#edit-ad-type-picker .ad-type-opt.selected')].map(el => el.dataset.type);
  return selected.length ? selected.join('+') : 'custom';
}

function closeEditModal() { document.getElementById('edit-modal-overlay').classList.remove('open'); }
function closeEditModalOutside(e) { if(e.target.id==='edit-modal-overlay') closeEditModal(); }

// ê¸°ë³¸ ì‚¬ì´íŠ¸ ìˆ˜ì • ë‚´ìš© ì €ì¥ìš©
function getOverrides() {
  try { return JSON.parse(localStorage.getItem('cpa_overrides') || '{}'); }
  catch { return {}; }
}
function saveOverrides(obj) { localStorage.setItem('cpa_overrides', JSON.stringify(obj)); }

function saveSite() {
  const id = document.getElementById('edit-id').value;
  const isDefault = document.getElementById('edit-is-default').value === 'true';
  let url = document.getElementById('edit-url').value.trim();
  const name = document.getElementById('edit-name').value.trim();
  const desc = document.getElementById('edit-detail').value.trim();
  const badge = getEditSelectedAdTypes();
  const emoji = editSelectedEmoji;

  if (!url) { highlightEl('edit-url'); return; }
  if (!name) { highlightEl('edit-name'); return; }
  if (!url.startsWith('http')) url = 'https://' + url;

  if (isDefault) {
    // ê¸°ë³¸ ì‚¬ì´íŠ¸: overridesì— ì €ì¥
    const overrides = getOverrides();
    const original = DEFAULT_SITES.find(s => s.id === id);
    overrides[id] = { ...original, url, name, desc, badge, emoji };
    saveOverrides(overrides);
  } else {
    // ì»¤ìŠ¤í…€ ì‚¬ì´íŠ¸: custom ë°°ì—´ì—ì„œ ì°¾ì•„ ìˆ˜ì •
    const custom = getCustom().map(s =>
      s.id === id ? { ...s, url, name, desc, badge, emoji } : s
    );
    saveCustom(custom);
  }

  closeEditModal();
  render();
  showToast(`"${name}" ìˆ˜ì • ì™„ë£Œ!`);
}

function highlightEl(id) {
  const el = document.getElementById(id);
  el.style.borderColor = 'var(--red)';
  el.focus();
  setTimeout(() => el.style.borderColor = '', 1600);
}

function deleteSite(e, id, isDefault) {
  e.preventDefault(); e.stopPropagation();
  if (isDefault) {
    const hidden = getHidden();
    if (!hidden.includes(id)) hidden.push(id);
    saveHidden(hidden);
  } else {
    saveCustom(getCustom().filter(s => s.id !== id));
  }
  render();
  showToast('ì‚¬ì´íŠ¸ ì‚­ì œ ì™„ë£Œ');
}

function resetCustomSites() {
  if (confirm('ì§ì ‘ ì¶”ê°€í•œ ì‚¬ì´íŠ¸ë¥¼ ëª¨ë‘ ì‚­ì œí•˜ê³ \nìˆ¨ê¸´ ê¸°ë³¸ ì‚¬ì´íŠ¸ë„ ëª¨ë‘ ë³µì›í• ê¹Œìš”?\n(ê¸°ë³¸ ì‚¬ì´íŠ¸ ìˆ˜ì • ë‚´ìš©ë„ ì´ˆê¸°í™”ë©ë‹ˆë‹¤)')) {
    saveCustom([]);
    saveHidden([]);
    saveOverrides({});
    render();
    showToast('ì „ì²´ ì´ˆê¸°í™” ì™„ë£Œ');
  }
}

function highlight(id) {
  const el = document.getElementById(id);
  el.style.borderColor = 'var(--red)';
  el.focus();
  setTimeout(() => el.style.borderColor = '', 1600);
}

function showToast(msg) {
  const t = document.getElementById('toast');
  document.getElementById('toast-msg').textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 3000);
}

// ì‹œê°„ / ë‚ ì§œ / ìš”ì¼
const WEEKDAYS = ['ì¼ìš”ì¼','ì›”ìš”ì¼','í™”ìš”ì¼','ìˆ˜ìš”ì¼','ëª©ìš”ì¼','ê¸ˆìš”ì¼','í† ìš”ì¼'];
const WEEKDAYS_EN = ['SUN','MON','TUE','WED','THU','FRI','SAT'];

function updateClock() {
  const now = new Date();
  document.getElementById('current-time').textContent =
    now.toLocaleTimeString('ko-KR',{hour:'2-digit',minute:'2-digit',second:'2-digit'});
  const d  = document.getElementById('stat-date');
  const y  = document.getElementById('stat-year');
  const c  = document.getElementById('stat-clock');
  const wd = document.getElementById('stat-day');
  const we = document.getElementById('stat-week');
  if (d)  d.textContent  = `${now.getMonth()+1}ì›” ${now.getDate()}ì¼`;
  if (y)  y.textContent  = `${now.getFullYear()}ë…„`;
  if (c)  c.textContent  = now.toLocaleTimeString('ko-KR',{hour:'2-digit',minute:'2-digit'});
  if (wd) wd.textContent = WEEKDAYS[now.getDay()];
  if (we) we.textContent = WEEKDAYS_EN[now.getDay()];
}
updateClock();
setInterval(updateClock, 1000);

// ì´ˆê¸°í™”
render();
</script>
</body>
</html>
